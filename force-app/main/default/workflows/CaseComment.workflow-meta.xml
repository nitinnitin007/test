<?xml version="1.0" encoding="UTF-8"?>
<Workflow xmlns="http://soap.sforce.com/2006/04/metadata">
    <alerts>
        <fullName>Red_Alert_Case_Comment_Created</fullName>
        <description>Red Alert Case Comment Created</description>
        <protected>false</protected>
        <recipients>
            <type>owner</type>
        </recipients>
        <recipients>
            <recipient>brandon.wolf@intapp.com</recipient>
            <type>user</type>
        </recipients>
        <recipients>
            <recipient>kshama.swamy@intapp.com</recipient>
            <type>user</type>
        </recipients>
        <recipients>
            <recipient>maiya.hilliard@intapp.com</recipient>
            <type>user</type>
        </recipients>
        <recipients>
            <recipient>mark.burgard@intapp.com</recipient>
            <type>user</type>
        </recipients>
        <recipients>
            <recipient>mark.hirsch@intapp.com</recipient>
            <type>user</type>
        </recipients>
        <recipients>
            <recipient>rob.weber@intapp.com</recipient>
            <type>user</type>
        </recipients>
        <recipients>
            <recipient>tariq.choudry@intapp.com</recipient>
            <type>user</type>
        </recipients>
        <recipients>
            <recipient>tim.nolan@intapp.com</recipient>
            <type>user</type>
        </recipients>
        <senderType>CurrentUser</senderType>
        <template>Customer_Support/Red_Alert_Case_Comment</template>
    </alerts>
    <fieldUpdates>
        <fullName>Case_Initial_Response_Time_Field_Update</fullName>
        <field>Case_Initial_Response_Time__c</field>
        <formula>( NOW()  -  Parent.CreatedDate ) * 24</formula>
        <name>Case Initial Response Time Field Update</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
        <targetObject>ParentId</targetObject>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Latest_Case_Comment</fullName>
        <description>For Executive Support Cases, update the Latest Case Comment for use in reporting.</description>
        <field>Latest_Case_Comment__c</field>
        <formula>CommentBody</formula>
        <name>Update Latest Case Comment</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
        <targetObject>ParentId</targetObject>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Latest_Case_Comment_Date</fullName>
        <description>For Executive Support Cases, this is the date of the most recent case comment added.  This is for reporting purposes.</description>
        <field>Latest_Case_Comment_Date__c</field>
        <formula>CreatedDate</formula>
        <name>Update Latest Case Comment Date</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
        <targetObject>ParentId</targetObject>
    </fieldUpdates>
    <fieldUpdates>
        <fullName>Update_Latest_Case_Comment_Owner</fullName>
        <description>For Executive Support Cases, this is the user that posted the latest case comment.</description>
        <field>Lastest_Case_Comment_Owner__c</field>
        <formula>CreatedById</formula>
        <name>Update Latest Case Comment Owner</name>
        <notifyAssignee>false</notifyAssignee>
        <operation>Formula</operation>
        <protected>false</protected>
        <reevaluateOnChange>false</reevaluateOnChange>
        <targetObject>ParentId</targetObject>
    </fieldUpdates>
    <rules>
        <fullName>Rule Code%3A CC-001xFxx</fullName>
        <actions>
            <name>Update_Latest_Case_Comment</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>Update_Latest_Case_Comment_Date</name>
            <type>FieldUpdate</type>
        </actions>
        <actions>
            <name>Update_Latest_Case_Comment_Owner</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <criteriaItems>
            <field>Case.Record_Type_Name__c</field>
            <operation>equals</operation>
            <value>Project Escalation</value>
        </criteriaItems>
        <description>Rule Code: CC-001xFxx
New Case Comment Created
Updates the Latest Case Comment Field on Red Alert Cases</description>
        <triggerType>onCreateOnly</triggerType>
    </rules>
    <rules>
        <fullName>Rule Code%3A CC-002xFxx</fullName>
        <actions>
            <name>Case_Initial_Response_Time_Field_Update</name>
            <type>FieldUpdate</type>
        </actions>
        <active>true</active>
        <description>Rule Code: CC-002xFxx
Case Initial Response Time Workflow
Updates the &quot;Case Initial Response Time&quot; field whenever certain user profiles enter information on the case comment.</description>
        <formula>($User.ProfileId = &apos;00e30000000bvR3&apos; || $User.ProfileId = &apos;00e50000001Bs3n&apos; || $User.ProfileId = &apos;00e50000000hvYj&apos; || $User.ProfileId = &apos;00e50000001BfGZ&apos; || $User.ProfileId = &apos;00e50000000iORk&apos; || $User.ProfileId = &apos;00e50000001BeRg&apos; || $User.ProfileId = &apos;00e50000001BrQf&apos; || $User.ProfileId = &apos;00e50000000zqps&apos;) &amp;&amp; ( $User.Id  &lt;&gt;  &apos;00530000000f63s&apos; ) &amp;&amp; ( ISBLANK( Parent.Case_Initial_Response_Time__c ) )</formula>
        <triggerType>onCreateOnly</triggerType>
    </rules>
    <rules>
        <fullName>Rule Code%3A CC-003Exxx</fullName>
        <actions>
            <name>Red_Alert_Case_Comment_Created</name>
            <type>Alert</type>
        </actions>
        <active>false</active>
        <description>Rule Code: CC-003Exxx
Red Alert Case Comment Created
Sends an email notification when a Red Alert Case Comment Created</description>
        <formula>Parent.RecordTypeId=&quot;0123000000008KH&quot;</formula>
        <triggerType>onCreateOnly</triggerType>
    </rules>
</Workflow>
