<?xml version="1.0" encoding="UTF-8"?>
<Flow xmlns="http://soap.sforce.com/2006/04/metadata">
    <apiVersion>49.0</apiVersion>
    <assignments>
        <name>Collect_data_from_PC_s</name>
        <label>Collect data from PC&apos;s</label>
        <locationX>824</locationX>
        <locationY>118</locationY>
        <assignmentItems>
            <assignToReference>TEXT_TO_SHOW</assignToReference>
            <operator>Add</operator>
            <value>
                <stringValue>&lt;tr&gt;&lt;td&gt;{!loop_pcs.Product_Line_New_Text__c} &lt;/td&gt; &lt;td&gt; &lt;font style=&quot;color:{!ambervalue}&quot;&gt;{!loop_pcs.CSM_Health_Rating__c}&lt;/font&gt;&lt;/td&gt;&lt;td&gt;{!loop_pcs.Product_Customer_Link__c} &lt;/td&gt;&lt;tr&gt;</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Table</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>&lt;table&gt;</stringValue>
            </value>
        </assignmentItems>
        <assignmentItems>
            <assignToReference>Table_close</assignToReference>
            <operator>Assign</operator>
            <value>
                <stringValue>&lt;/table&gt;</stringValue>
            </value>
        </assignmentItems>
        <connector>
            <targetReference>loop_pc_1</targetReference>
        </connector>
    </assignments>
    <formulas>
        <name>ambervalue</name>
        <dataType>String</dataType>
        <expression>if (ISPICKVAL({!loop_pcs.CSM_Health_Rating__c},&quot;Amber&quot;), &quot;#ffbf00&quot; ,TEXT({!loop_pcs.CSM_Health_Rating__c}))</expression>
    </formulas>
    <interviewLabel>csm product status to case one field {!$Flow.CurrentDateTime}</interviewLabel>
    <label>csm product status to case one field</label>
    <loops>
        <name>loop_pc_1</name>
        <label>loop pcs</label>
        <locationX>616</locationX>
        <locationY>127</locationY>
        <assignNextValueToReference>loop_pcs</assignNextValueToReference>
        <collectionReference>All_PC</collectionReference>
        <iterationOrder>Asc</iterationOrder>
        <nextValueConnector>
            <targetReference>Collect_data_from_PC_s</targetReference>
        </nextValueConnector>
        <noMoreValuesConnector>
            <targetReference>update_product_csm_status</targetReference>
        </noMoreValuesConnector>
    </loops>
    <processMetadataValues>
        <name>BuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processMetadataValues>
        <name>OriginBuilderType</name>
        <value>
            <stringValue>LightningFlowBuilder</stringValue>
        </value>
    </processMetadataValues>
    <processType>AutoLaunchedFlow</processType>
    <recordLookups>
        <name>Get_product_customers_CRM</name>
        <label>Get product customers CRM</label>
        <locationX>380</locationX>
        <locationY>84</locationY>
        <assignNullValuesIfNoRecordsFound>true</assignNullValuesIfNoRecordsFound>
        <connector>
            <targetReference>loop_pc_1</targetReference>
        </connector>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Account__c</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>Account_id</elementReference>
            </value>
        </filters>
        <object>Subscription__c</object>
        <outputReference>All_PC</outputReference>
        <queriedFields>Id</queriedFields>
        <queriedFields>Status__c</queriedFields>
        <queriedFields>Product_Line_New_Text__c</queriedFields>
        <queriedFields>CSM_Health_Rating__c</queriedFields>
        <queriedFields>Product_Customer_Link__c</queriedFields>
        <queriedFields>Notes__c</queriedFields>
    </recordLookups>
    <recordUpdates>
        <name>update_product_csm_status</name>
        <label>update_product_csm_status</label>
        <locationX>637</locationX>
        <locationY>451</locationY>
        <filterLogic>and</filterLogic>
        <filters>
            <field>Id</field>
            <operator>EqualTo</operator>
            <value>
                <elementReference>case_id</elementReference>
            </value>
        </filters>
        <inputAssignments>
            <field>RAG_Statuses__c</field>
            <value>
                <stringValue>{!Table}{!TEXT_TO_SHOW}{!Table_close}</stringValue>
            </value>
        </inputAssignments>
        <object>Case</object>
    </recordUpdates>
    <start>
        <locationX>186</locationX>
        <locationY>50</locationY>
        <connector>
            <targetReference>Get_product_customers_CRM</targetReference>
        </connector>
    </start>
    <status>Active</status>
    <variables>
        <name>Account_id</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>All_PC</name>
        <dataType>SObject</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Subscription__c</objectType>
    </variables>
    <variables>
        <name>Amber</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>case_id</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>CRM_Status</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>loop_pcs</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Subscription__c</objectType>
    </variables>
    <variables>
        <name>Product_Name</name>
        <dataType>String</dataType>
        <isCollection>true</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>Productname</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>true</isInput>
        <isOutput>true</isOutput>
    </variables>
    <variables>
        <name>Table</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>Table_close</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>TEXT_TO_SHOW</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
    <variables>
        <name>updatecase</name>
        <dataType>SObject</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
        <objectType>Case</objectType>
    </variables>
    <variables>
        <name>Walls_csm_status</name>
        <dataType>String</dataType>
        <isCollection>false</isCollection>
        <isInput>false</isInput>
        <isOutput>false</isOutput>
    </variables>
</Flow>
